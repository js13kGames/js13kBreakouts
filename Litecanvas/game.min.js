(()=>{var gt=(s=1,i=.05,n=220,p=0,l=0,y=.1,m=0,_=1,c=0,w=0,O=0,b=0,H=0,X=0,a=0,Q=0,C=0,$=1,M=0,q=0,P=0)=>{let D=Math,A=2*D.PI,v=44100,tt=c*=500*A/v/v,j=n*=(1-i+2*i*D.random(i=[]))*A/v,k=0,z=0,I=0,r=1,rt=0,et=0,S=0,N=P<0?-1:1,G=A*N*P*2/v,t=D.cos(G),e=D.sin,o=e(G)/4,h=1+o,u=-2*t/h,T=(1-o)/h,E=(1+N*t)/2/h,R=-(N+t)/h,f=E,x=0,d=0,g=0,Y=0;for(p=v*p+9,M*=v,l*=v,y*=v,C*=v,w*=500*A/v**3,a*=A/v,O*=A/v,b*=v,H=v*H|0,s*=globalThis.zzfxV||.3,N=p+M+l+y+C|0;I<N;i[I++]=S*s)++et%(100*Q|0)||(S=m?1<m?2<m?3<m?e(k*k):D.max(D.min(D.tan(k),1),-1):1-(2*k/A%2+2)%2:1-4*D.abs(D.round(k/A)-k/A):e(k),S=(H?1-q+q*e(A*I/H):1)*(S<0?-1:1)*D.abs(S)**_*(I<p?I/p:I<p+M?1-(I-p)/M*(1-$):I<p+M+l?$:I<N-C?(N-I-C)/y*$:0),S=C?S/2+(C>I?0:(I<N-C?1:(N-I)/C)*i[I-C|0]/2/s):S,P&&(S=Y=f*x+R*(x=d)+E*(d=S)-T*g-u*(g=Y))),G=(n+=c+=w)*D.cos(a*z++),k+=G+G*X*e(I**5),r&&++r>b&&(n+=O,j+=O,r=0),!H||++rt%H||(n=j,c=tt,r=r||1);s=ft.createBuffer(1,N,v),s.getChannelData(0).set(i),n=ft.createBufferSource(),n.buffer=s,n.connect(ft.destination),n.start()},ft=new AudioContext;var at=["#18161c","#6a7799","#aec2c2","#f3eade","#f04f78","#fcf660","#2f328f","#4b80ca","#327345","#63c64d","#703075","#a56243"];var nt=[[.8,0,2e3,.01,.05,,1,2,,,-600,.05,,,,,,.5,.05],[.5,0,375,.02,.01,.2,1,,,,,,,.4,,.1,,.6,.1],[,0,360,.01,,.08,1,1.7,12,32,,,,,,,,.63,.02,,99],[1.2,0,240,.02,.15,.15,1,4,,,,,.05,,,,,.6,.15]];function pt(s={}){let i=globalThis,n=Math.PI,p=n*2,l=(t,e,o)=>t.addEventListener(e,o);s=Object.assign({fps:60,fullscreen:!0,width:null,height:null,autoscale:!0,pixelart:!1,antialias:!0,canvas:null,global:!0,loop:null,tapEvents:!0,pauseOnBlur:!0},s);let m=!1,_=[],c=s.canvas||document.createElement("canvas"),w=s.fullscreen,O=s.autoscale,b=1,H,X,a,Q=1,C,$=1/s.fps,M=$*1e3,q=0,P,D=0,A=0,v="sans-serif",tt="",j=32,k=Date.now(),z={init:!1,update:!1,draw:!1,resized:!1,tap:!1,untap:!1,tapping:!1,tapped:!1},I={settings:Object.assign({},s),colors:at,sounds:nt},r={WIDTH:s.width,HEIGHT:s.height||s.width,CANVAS:null,ELAPSED:0,FPS:s.fps,CENTERX:null,CENTERY:null,PI:n,TWO_PI:p,HALF_PI:n*.5,lerp:(t,e,o)=>t+o*(e-t),deg2rad:t=>n/180*t,rad2deg:t=>180/n*t,clamp:(t,e,o)=>t<e?e:t>o?o:t,wrap:(t,e,o)=>t-(o-e)*Math.floor((t-e)/(o-e)),map(t,e,o,h,u,T=!1){let E=(t-e)/(o-e)*(u-h)+h;return T?r.clamp(E,h,u):E},norm:(t,e,o)=>r.map(t,e,o,0,1),rand:(t=0,e=1)=>(k=(1664525*k+1013904223)%4294967296,k/4294967296*(e-t)+t),randi:(t=0,e=1)=>r.floor(r.rand()*(e-t+1)+t),seed:t=>t==null?k:k=~~t,cls(t){t==null?a.clearRect(0,0,r.WIDTH,r.HEIGHT):r.rectfill(0,0,r.WIDTH,r.HEIGHT,t)},rect(t,e,o,h,u=0,T=null){a.beginPath(),a[T?"roundRect":"rect"](~~t,~~e,o,h,T),r.stroke(u)},rectfill(t,e,o,h,u=0,T=null){a.beginPath(),a[T?"roundRect":"rect"](~~t,~~e,o,h,T),r.fill(u)},circ(t,e,o,h=0){a.beginPath(),a.arc(~~t,~~e,o,0,p),a.closePath(),r.stroke(h)},circfill(t,e,o,h=0){a.beginPath(),a.arc(~~t,~~e,o,0,p),a.closePath(),r.fill(h)},line(t,e,o,h,u=0){a.beginPath(),a.moveTo(~~t,~~e),a.lineTo(~~o,~~h),r.stroke(u)},linewidth(t){a.lineWidth=t},linedash(t,e=0){a.setLineDash(Array.isArray(t)?t:[t]),a.lineDashOffset=e},text(t,e,o,h=3){a.font=`${tt||""} ${j}px ${v}`,a.fillStyle=r.getcolor(h),a.fillText(o,~~t,~~e)},textfont(t){v=t},textsize(t){j=t},textstyle(t){tt=t},textalign(t,e){t&&(a.textAlign=t),e&&(a.textBaseline=e)},textmetrics(t,e){return a.font=`${tt||""} ${e||j}px ${v}`,metrics=a.measureText(t),metrics.height=metrics.actualBoundingBoxAscent+metrics.actualBoundingBoxDescent,metrics},image(t,e,o){a.drawImage(o,~~t,~~e)},paint(t,e,o,h={}){let u=new OffscreenCanvas(t,e),T=a,E=h.scale||1;if(u.width=t*E,u.height=e*E,a=u.getContext("2d"),a.scale(E,E),Array.isArray(o)){let R=0,f=0;a.imageSmoothingEnabled=!1;for(let x of o){for(let d of x)d!==" "&&d!=="."&&r.rectfill(R,f,1,1,parseInt(d,16)),R++;f++,R=0}}else o(u,a);return a=T,u},ctx:()=>a,push:()=>a.save(),pop:()=>a.restore(),translate:(t,e)=>a.translate(t,e),scale:(t,e)=>a.scale(t,e||t),rotate:t=>a.rotate(t),transform:(t,e,o,h,u,T,E=!0)=>a[E?"setTransform":"transform"](t,e,o,h,u,T),alpha(t){a.globalAlpha=t},path:t=>new Path2D(t),fill(t,e){a.fillStyle=r.getcolor(t),a.fill(e)},stroke(t,e){a.strokeStyle=r.getcolor(t),e?a.stroke(e):a.stroke()},cliprect(t,e,o,h){a.beginPath(),a.rect(t,e,o,h),a.clip()},clipcirc(t,e,o){a.beginPath(),a.arc(t,e,o,0,p),a.clip()},blendmode(t){a.globalCompositeOperation=t},sfx(t=0,e=1,o=0,h=0){if(navigator.userActivation&&!navigator.userActivation.hasBeenActive)return;let u=Array.isArray(t)?t:nt[t%nt.length];return(e!==1||o||h)&&(u=[...u],u[0]=(Number(e)||1)*(u[0]||1),u[1]=h>0?h:0,u[10]=~~u[10]+~~o),gt(...u)},colrect:(t,e,o,h,u,T,E,R)=>t<u+E&&t+o>u&&e<T+R&&e+h>T,colcirc:(t,e,o,h,u,T)=>(h-t)**2+(u-e)**2<=(o+T)**2,mousepos:()=>[H,X],timescale(t){Q=t},use(t,e={}){t.__conf=e,m?G(t):_.push(t)},listen(t,e,o=!1){z[t]=z[t]||[[],[]];let h=z[t][o?0:1].push(e);return()=>{z[t][o?0:1].splice(h-1,1)}},emit(t,...e){if(z[t])for(let o of z[t])for(let h of o)h(...e)},getcolor:t=>at[~~t%at.length],setvar(t,e){r[t]=e,s.global&&(i[t]=e)},resize(t,e){r.setvar("WIDTH",c.width=t),r.setvar("HEIGHT",c.height=e||t),N()}};for(let t of["sin","cos","atan2","hypot","tan","abs","ceil","round","floor","trunc","min","max","pow","sqrt","sign","exp"])r[t]=Math[t];function rt(){m=!0,S();let t=s.loop?s.loop:i;for(let e of Object.keys(z))t[e]&&r.listen(e,t[e]);for(let e of _)G(e);if(l(i,"resize",N),N(),s.tapEvents){let e=(f,x)=>[(f-c.offsetLeft)/b,(x-c.offsetTop)/b],o=new Map,h=(f,x,d)=>{let g={x,y:d,startX:x,startY:d,ts:performance.now()};return o.set(f,g),g},u=(f,x,d)=>{let g=o.get(f)||h(f);g.x=x,g.y=d},T=f=>f&&performance.now()-f.ts<=200,E=!1;l(c,"mousedown",f=>{f.preventDefault();let[x,d]=e(f.pageX,f.pageY);r.emit("tap",x,d,0),h(0,x,d),E=!0}),l(c,"mousemove",f=>{f.preventDefault();let[x,d]=[H,X]=e(f.pageX,f.pageY);E&&(r.emit("tapping",x,d,0),u(0,x,d))}),l(c,"mouseup",f=>{f.preventDefault();let x=o.get(0),[d,g]=e(f.pageX,f.pageY);T(x)&&r.emit("tapped",x.startX,x.startY,0),r.emit("untap",d,g,0),o.delete(0),E=!1}),l(c,"touchstart",f=>{f.preventDefault();let x=f.changedTouches;for(let d of x){let[g,Y]=e(d.pageX,d.pageY);r.emit("tap",g,Y,d.identifier+1),h(d.identifier+1,g,Y)}}),l(c,"touchmove",f=>{f.preventDefault();let x=f.changedTouches;for(let d of x){let[g,Y]=e(d.pageX,d.pageY);r.emit("tapping",g,Y,d.identifier+1),u(d.identifier+1,g,Y)}});let R=f=>{f.preventDefault();let x=[];if(f.targetTouches.length>0)for(let d of f.targetTouches)x.push(d.identifier+1);for(let[d,g]of o)x.includes(d)||(T(g)&&r.emit("tapped",g.startX,g.startY,d),r.emit("untap",g.x,g.y,d),o.delete(d))};l(c,"touchend",R),l(c,"touchcancel",R),l(i,"blur",()=>{if(E=!1,o.size!==0)for(let[f,x]of o)r.emit("untap",x.x,x.y,f),o.delete(f)})}s.pauseOnBlur&&(l(i,"blur",()=>{P=null}),l(i,"focus",()=>{P||(C=performance.now(),P=requestAnimationFrame(et))})),r.emit("init"),C=performance.now(),P=requestAnimationFrame(et)}function et(t){let e=0,o=t-C;for(C=t,q+=o;q>=M;)r.emit("update",$*Q),r.setvar("ELAPSED",r.ELAPSED+$*Q),q-=M,e++;e&&(r.textalign("start","top"),r.emit("draw"),D++,A+=M*e,A+q>=1e3&&(r.setvar("FPS",D),D=0,A-=1e3)),P&&(P=requestAnimationFrame(et))}function S(){c=typeof c=="string"?document.querySelector(c):c,r.setvar("CANVAS",c),a=c.getContext("2d"),r.WIDTH>0&&(w=!1),c.width=r.WIDTH,c.height=r.HEIGHT||r.WIDTH,c.parentNode||document.body.appendChild(c),c.style.display="block",w?(c.style.position="absolute",c.style.inset=0):O&&(c.style.margin="auto")}function N(){w?(c.width=innerWidth,c.height=innerHeight,r.setvar("WIDTH",innerWidth),r.setvar("HEIGHT",innerHeight)):O&&(b=Math.min(innerWidth/r.WIDTH,innerHeight/r.HEIGHT),b=s.pixelart?Math.floor(b):b,c.style.width=r.WIDTH*b+"px",c.style.height=r.HEIGHT*b+"px"),r.setvar("CENTERX",r.WIDTH/2),r.setvar("CENTERY",r.HEIGHT/2),(!s.antialias||s.pixelart)&&(a.imageSmoothingEnabled=!1,c.style.imageRendering="pixelated"),r.emit("resized",b)}function G(t){let e=t(r,I,t.__conf);if(typeof e=="object")for(let[o,h]of Object.entries(e))r.setvar(o,h)}if(s.global){if(i.__litecanvas)throw"Cannot instantiate litecanvas globally twice";Object.assign(i,r),i.__litecanvas=r}return document.readyState==="loading"?l(i,"DOMContentLoaded",rt):rt(),r}var ut=(s,i,n,p,l,y,m,_)=>{let c=Math.max(s,l),w=Math.min(s+n,l+m)-c,O=Math.max(i,y),b=Math.min(i+p,y+_)-O;return[c,O,w,b]};var dt=(s,i,n,p,l,y,m,_)=>{let[c,w,O,b]=ut(s,i,n,p,l,y,m,_),H="",X=s,a=i;return O<b?s<l?(H="right",X=l-n):(H="left",X=l+m):i<y?(H="bottom",a=y-p):(H="top",a=y+_),{direction:H,x:X,y:a}};var xt=class{x;y;constructor(i=0,n=i){this.x=i,this.y=n}toString(){return`Vector (${this.x}, ${this.y})`}},W=(s=0,i=s)=>new xt(s,i);var mt=(s,i)=>{let n=Math.cos(i),p=Math.sin(i);s.x=n*s.x-p*s.y,s.y=p*s.x+n*s.y},Tt=s=>Math.sqrt(s.x*s.x+s.y*s.y);var st=[,,1e3,,.03,.02,1,2,,,940,.03,,,,,.2,.6,,.06],yt=[.5,0,500,,.04,.3,1,2,,,570,.02,.02,,,,.04],_t=[1.31,,154,.05,.3,.37,1,.3,-9.9,-6.9,,,.11,,,.2,.02,.42,.16];var it=class{dx;pos=W();width=230;height=50;color=2;borderRadius=[10];constructor(i,n){this.pos.x=i-this.width/2,this.pos.y=n}aabb(){return[this.pos.x,this.pos.y,this.width,this.height]}moveTo(i){this.dx=i}update(i){this.dx!=null&&(this.pos.x=clamp(lerp(this.pos.x,this.dx,.1),0,WIDTH-this.width))}draw(){rectfill(this.pos.x,this.pos.y,this.width,this.height,this.color,this.borderRadius)}},ct=class{pos=W();velocity=W();radius=30;color=2;offscreen=!1;constructor(){this.reset()}aabb(){return[this.pos.x-this.radius,this.pos.y-this.radius,this.radius*2,this.radius*2]}reset(){this.velocity.x=0,this.velocity.y=900,this.pos.x=CENTERX,this.pos.y=CENTERY,this.offscreen=!1}update(i){this.offscreen||(this.pos.x+=this.velocity.x*i,this.pos.y+=this.velocity.y*i,this.pos.y-this.radius<0?(this.pos.y=this.radius,this.velocity.y*=-1,sfx(st)):this.pos.x-this.radius<0?(this.pos.x=this.radius,this.velocity.x*=-1,sfx(st)):this.pos.x+this.radius>WIDTH?(this.pos.x=WIDTH-this.radius,this.velocity.x*=-1,sfx(st)):this.pos.y-this.radius>HEIGHT&&(this.offscreen=!0,sfx(_t)))}draw(){this.offscreen||circfill(this.pos.x,this.pos.y,this.radius,this.color)}checkCollision(i){let n=this.aabb(),p=i.aabb();if(colrect(...n,...p)){sfx(st);let{direction:l,x:y,y:m}=dt(...n,...p);if(l&&(this.pos.x=y+this.radius,this.pos.y=m+this.radius),i instanceof it)switch(l){case"bottom":let _=i.pos.x+i.width/2,c=i.pos.y+i.height/2,w=clamp(atan2(this.pos.y-c,this.pos.x-_),deg2rad(-135),deg2rad(-45)),O=Tt(this.velocity);mt(this.velocity,w),this.velocity.x=O*cos(w),this.velocity.y=-clamp(abs(this.velocity.y),900,1200);break;case"left":case"right":this.velocity.x*=-1,this.velocity.y=abs(this.velocity.y)>0?this.velocity.y:900}else if(i instanceof ot)switch(l){case"top":case"bottom":this.velocity.y*=-1;break;case"left":case"right":this.velocity.x*=-1}return!0}return!1}},ot=class{pos=W();velocity=W();width=0;height=0;color=0;borderRadius=[10];constructor(i,n,p,l,y){this.pos.x=i,this.pos.y=n,this.width=p,this.height=l,this.color=y}center(){return W(this.pos.x+this.width/2,this.pos.y+this.height/2)}aabb(){return[this.pos.x,this.pos.y,this.width,this.height]}draw(){rectfill(this.pos.x,this.pos.y,this.width,this.height,this.color,this.borderRadius)}},lt=class{pos=W();velocity=W();radius=0;color=0;constructor(i,n){this.pos.x=i,this.pos.y=n,this.velocity.x=(rand()<.5?1:-1)*rand(0,480),this.velocity.y=(rand()<.5?1:-1)*rand(0,480),this.opacity=rand(),this.radius=randi(15,30),this.color=11,this.lifespan=1}update(i){this.lifespan-=i,this.opacity=max(0,this.opacity-.05),this.pos.x+=this.velocity.x*i,this.pos.y+=this.velocity.y*i}draw(){push(),alpha(this.opacity),circfill(this.pos.x,this.pos.y,this.radius,this.color),pop()}};function vt(s,{colors:i}){let n=["#212633","#4c4c4c","#ffffff","#700f16","#76121a","#7c151d","#831720","#891a23","#901d26","#96202a","#9c232d","#9c232d"];i.length=n.length;for(let[p,l]of n.entries())i[p]=l}function Et(s){return s.setvar("LOADING",0),{loadImage:async(n,p)=>{let l=new Image;l.crossOrigin="anonymous",s.setvar("LOADING",s.LOADING+1),l.onload=()=>{p(l),s.setvar("LOADING",s.LOADING-1)},l.src=n}}}var wt="js13breakouts_litecanvas_highscore",It={};var L,F,U,B,K,ht=localStorage.getItem(wt)||0,V,Z,J=0;pt({width:1080,height:1920,loop:{init:bt,update:Dt,draw:Ct,tapped:Ht}});use(vt);use(Et);function bt(){K=0,V=!1,loadImage("logo.png",s=>{It.logo=s})}function Ht(s,i,n){LOADING||(V?Z?J>0?(L.reset(),sfx(yt),Z=!1):V=!1:n>0&&F.moveTo(s):At())}function Dt(s){LOADING||V&&Nt(s)}function Ct(){cls(0),!LOADING&&(push(),V?Ot():kt(),pop())}function At(){if(V)return;F=F||new it(CENTERX,HEIGHT-100),L=L||new ct,L.reset(),sfx(yt),B=[],U=[];let s=8,i=16,n=8,p=7,l=(WIDTH-(p-1)*i-s*2)/7,y=48,m=200,_=s;for(let c=0;c<p;c++)for(let w=0;w<n;w++)U.push(new ot(_+c*l+c*i,m+w*y+w*i,l,y,w+3));V=!0,Z=!1,J=3,K=0}function kt(){push(),scale(1.75),image(50,100,It.logo),pop(),textsize(150),textalign("center","middle"),text(CENTERX,CENTERY+200,"Tap to Play",2),textsize(90),text(CENTERX,CENTERY+400,"High Score",2),text(CENTERX,CENTERY+520,ht,2)}function Nt(s){let[i]=mousepos();if(i>=0&&F.moveTo(i),F.update(),!Z){let p=s/4,l=!1;for(let y=0;y<4;y++){if(L.update(p),L.offscreen){J--,J===0&&K>ht&&(ht=K,localStorage.setItem(wt,ht)),Z=!0;break}if(!l){l=L.checkCollision(F);for(let m=0;m<U.length;m++){let _=U[m];if(l=L.checkCollision(_),l){U.splice(m,1),K++;for(let c=0;c<25;c++)B.push(new lt(_.pos.x+_.width/2,_.pos.y+_.height/2));break}}}}}for(let n=0;n<B.length;n++)B[n].update(s),B[n].lifespan<=0&&B.splice(n,1)}function Ot(){F.draw(),L.draw();for(let s=0;s<U.length;s++)U[s].draw();for(let s=0;s<B.length;s++)B[s].draw();if(St(),Pt(),Z){textsize(150),textalign("center","middle");let s=J>0?"Tap to Play":"Game Over!";text(CENTERX,CENTERY+200,s,2)}}function St(){push();let s=50,i=15;translate(CENTERX-s-i,50);for(let n=0;n<3;n++){let p=n<J?2:1;rectfill(n*s+n*i,0,s,s,p,[5])}pop()}function Pt(){textsize(60),text(50,50,K,2)}})();
